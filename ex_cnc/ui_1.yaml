# Simple CNC interface

- size: [100%, 100%]
  id: "@main_container"
  layout: LV_LAYOUT_FLEX
  flex_align: [LV_FLEX_ALIGN_SPACE_EVENLY, LV_FLEX_ALIGN_CENTER, LV_FLEX_ALIGN_CENTER]
  flex_flow: LV_FLEX_FLOW_COLUMN
  children:
    - layout: LV_LAYOUT_FLEX
      id: "@top_container"
      flex_align: [LV_FLEX_ALIGN_SPACE_EVENLY, LV_FLEX_ALIGN_CENTER, LV_FLEX_ALIGN_CENTER]
      flex_flow: LV_FLEX_FLOW_ROW
      children:
        - layout: LV_LAYOUT_FLEX
          id: "@right_top_panel"
          flex_align: [LV_FLEX_ALIGN_SPACE_EVENLY, LV_FLEX_ALIGN_CENTER, LV_FLEX_ALIGN_CENTER]
          flex_flow: LV_FLEX_FLOW_COLUMN
          children:
            - layout: LV_LAYOUT_FLEX
              id: "@position_panel"
              flex_align: [LV_FLEX_ALIGN_SPACE_EVENLY, LV_FLEX_ALIGN_CENTER, LV_FLEX_ALIGN_CENTER]
              flex_flow: LV_FLEX_FLOW_COLUMN
              children:
                - type: label
                  text: "X: 000000.00"
                  observes:
                    position::absolute::x: { float: "X: %+07.2f" }
                - type: label
                  observes:
                  text: "Y: 000000.00"
                    position::absolute::y: { float: "Y: %+07.2f" }
                - type: label
                  observes:
                  text: "Z: 000000.00"
                    position::absolute::z: { float: "Z: %+07.2f" }
                - type: label
                  observes:
                    spindle::rpm: { float: "RPM: %05.0f" }

    - layout: LV_LAYOUT_FLEX
      id: "@bottom_container"
      flex_align: [LV_FLEX_ALIGN_SPACE_EVENLY, LV_FLEX_ALIGN_CENTER, LV_FLEX_ALIGN_CENTER]
      flex_flow: LV_FLEX_FLOW_ROW


# - type: obj
  id: '@main_container'
  width: lv_pct(100)
  height: lv_pct(100)
  # Use proper enum names for layout properties
  flex_flow: LV_FLEX_FLOW_COLUMN
  flex_main_place: LV_FLEX_ALIGN_SPACE_EVENLY
  flex_cross_place: LV_FLEX_ALIGN_CENTER
  style_pad_all: 10
  children:
    - type: label
      text: "Mini CNC Simulator"
      # Reference the font from the registry
      style_text_font: '@montserrat_20'

    # --- Position Readouts ---
    - type: obj
      width: lv_pct(95)
      flex_flow: LV_FLEX_FLOW_COLUMN
      flex_cross_place: LV_FLEX_ALIGN_START
      children:
        - type: label
          text: "Machine Status & Position"
        - type: obj
          id: '@position_panel'
          width: lv_pct(100)
          height: LV_SIZE_CONTENT
          style_pad_all: 10
          style_radius: 5
          style_bg_color: '#2c3e50'
          flex_flow: LV_FLEX_FLOW_ROW
          flex_main_place: LV_FLEX_ALIGN_SPACE_AROUND
          children:
            - type: label
              observes:
                position::absolute::x: { float: "X: %+07.2f" }
            - type: label
              observes:
                position::absolute::y: { float: "Y: %+07.2f" }
            - type: label
              observes:
                spindle::rpm: { float: "RPM: %05.0f" }

    # --- Actions Panel ---
    - type: obj
      id: '@actions_panel'
      width: lv_pct(95)
      flex_flow: LV_FLEX_FLOW_ROW_WRAP # Use WRAP for better spacing
      flex_main_place: LV_FLEX_ALIGN_SPACE_EVENLY
      flex_cross_place: LV_FLEX_ALIGN_CENTER
      style_pad_all: 5
      children:
        - type: button
          action:
            program::run_toggle: "trigger"
          children:
            - type: label
              id: '@run_button_label'
              # This observer will change the button text between "RUN" and "PAUSE"
              observes:
                program_running: { bool: "%s" }

        - type: button
          action:
            position::home: "trigger"
          children:
            - type: label
              text: "Home Axes"
              
        - type: switch
          id: '@switch_spindle'
          action:
            spindle_enable: "toggle"
          observes:
            spindle_on: { bool: null }
        
        - type: button
          id: '@btn_feed_override'
          action:
            feed_override: [100, 125, 150, 50, 75]
          children:
            - type: label
              observes:
                feed_override: { int: "Feed: %d%%" }
